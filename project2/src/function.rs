fn f1(x : f64, y: f64, z: f64) -> f64 {    // 15x + y^2 - 4z - 13
    15.0 * x + (y*y) - 4.0 * z - 13.0
}

fn f2(x : f64, y: f64, z: f64) -> f64 {     // x^2 + 10y - z - 11
    x*x + 10.0 * y - z - 11.0
}

fn f3(x : f64, y: f64, z: f64) -> f64 {     // y^3 - 25z + 22
    y*y*y - 25.0 * z + 22.0
}

pub fn G(x : f64, y: f64, z: f64) -> f64 {  // f1^2 + f2^2 + f3^2
    f1(x, y, z) * f1(x, y, z) +
    f2(x, y, z) * f2(x, y, z) +
    f3(x, y, z) * f3(x, y, z)
}

pub fn dG(x : f64, y: f64, z: f64) -> (f64, f64, f64) {
    (
        2.0 * (f1(x, y, z) * 15.0 + 
               f2(x, y, z) * 2.0 * x + 
               0.0),

        2.0 * (f1(x, y, z) * 2.0 * y +
               f2(x, y, z) * 10.0 +
               f3(x, y, z) * 3.0 * y * y),

        2.0 * (f1(x, y, z) * -4.0 +
               f2(x, y, z) * -1.0 +
               f3(x, y, z) * -25.0)
    )
}